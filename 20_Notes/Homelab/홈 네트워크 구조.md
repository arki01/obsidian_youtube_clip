---
Created: 2025-12-29 23:41
tags:
  - AI/개발
---

## 1. 문서 개요

본 문서는 개인 홈랩 환경에서  
**외부 공격면을 최소화하면서도 안정적인 원격 접근과 서비스 공개를 가능하게 하는 네트워크 보안 구조**를 정의한다.

---

## 2. 전체 설계 원칙 (Design Principles)

### 2.1 핵심 원칙

1. **공인 IP는 존재하되, 외부에서 직접 접근 가능한 서비스는 0**
    
2. **외부 사용자용 서비스와 관리자용 접근 경로를 완전히 분리**
    
3. **포트포워딩 최소화 (가능하면 0)**
    
4. **VPN 기반 Zero Trust 접근**
    
5. **관리 포인트는 항상 내부 또는 VPN 경유**
    

---

## 3. 네트워크 토폴로지 개요

```
[ Internet ]
     |
     |  (공인 IP: ISP 제공)
     |
[ipTIME Router]
     |
     |-- LAN (192.168.0.0/24)
           |
           |-- Proxmox Host (192.168.0.10)
           |     └─ Windows VM (192.168.0.22)
           |
           |-- Ubuntu Server (192.168.0.20)
                 ├─ Docker
                 │    ├─ OpenWebUI (3000)
                 │    ├─ Portainer (9000)
                 │    └─ 기타 서비스
                 |
                 └─ cloudflared / tailscale
```

---

## 4. 외부 접근 구조 (Public Access)

### 4.1 Cloudflare Tunnel 기반 서비스 공개

|항목|내용|
|---|---|
|방식|Cloudflare Tunnel (Outbound Only)|
|포트포워딩|❌ 사용 안 함|
|TLS|Cloudflare 자동 HTTPS|
|외부 노출 IP|없음 (Cloudflare Edge IP만 노출)|

### 4.2 공개 도메인 구조

|서비스|도메인|내부 연결|
|---|---|---|
|OpenWebUI|`ai.zoai.uk`|`http://192.168.0.20:3000`|
|Portainer|`docker.zoai.uk`|`http://192.168.0.20:9000`|

> 외부에서는 실제 서버 IP/포트를 알 수 없음

---

## 5. 관리자 접근 구조 (Private Access)

### 5.1 Tailscale 기반 VPN

|대상|접근 방식|
|---|---|
|ipTIME 관리|Tailscale → 내부 IP|
|Proxmox|Tailscale|
|Ubuntu Server|Tailscale / SSH|
|Windows VM|Tailscale + RDP|

### 5.2 관리자 접근 원칙

- ❌ 공인 IP 직접 접근 금지
    
- ❌ 포트포워딩 금지
    
- ⭕ Tailscale 인증된 기기만 접근 허용
    

---

## 6. ipTIME 공유기 보안 설정 요약

### 6.1 WAN 보안 정책

- 외부 관리 포트 ❌ 비활성화
    
- 공유기 관리자 외부 접근 ❌ 차단
    
- WAN → LAN 기본 차단 ⭕
    
- DMZ ❌ 사용 안 함
    
- UPnP ❌ 비활성화
    

### 6.2 DDNS 정책

- DDNS ⭕ 유지
    
- 용도: IP 확인 / 디버깅
    
- ❌ 관리 접속용으로 사용하지 않음
    

---

## 7. 공인 IP 접근 정책에 대한 정의

### 7.1 공인 IP 접근 상태

- `http://공인IP` 접속 시:
    
    - ISP 기본 응답 페이지 또는 빈 응답 가능
        
    - 내부 서비스/관리 페이지 노출 ❌
        

### 7.2 보안 해석

- 공인 IP 응답 여부 ≠ 보안 취약점
    
- **실제 기준은 “내부 서비스 노출 여부”**
    

---

## 8. 위협 모델 & 대응

|위협|대응|
|---|---|
|포트 스캔|모든 포트 차단|
|관리자 페이지 공격|외부 접근 차단|
|IP 노출|Cloudflare Edge IP만 노출|
|인증 우회|Tailscale + Cloudflare 인증|
|내부 침투|Zero Trust 구조|

---

## 9. 보안 수준 평가

|항목|수준|
|---|---|
|외부 공격면|매우 낮음|
|관리 접근 통제|매우 높음|
|운영 복잡도|중간|
|확장성|높음|

**종합 평가: 개인 홈랩 기준 최상급 보안 구조**

---

## 10. 운영 가이드 (Operational Rules)

### 10.1 반드시 지킬 것

- 새 서비스 공개 시 → **Cloudflare Tunnel 우선**
    
- 포트포워딩은 최후의 수단
    
- 관리자 접근은 항상 Tailscale
    

### 10.2 하지 말아야 할 것

- Proxmox / Router / SSH 포트 외부 개방
    
- UPnP 재활성화
    
- 공인 IP 직접 서비스 운영
    

---

## 11. 향후 확장 방향 (Optional)

- Cloudflare Access + MFA
    
- Tailscale ACL 세분화
    
- 내부 Reverse Proxy 통합
    
- 서비스별 서브도메인 표준화
    

---

## 12. 한 줄 요약

> **“외부에는 Cloudflare만 보이고,  
> 내부와 관리는 VPN으로만 접근한다.”**
