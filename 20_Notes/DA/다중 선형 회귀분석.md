---
Created: 2023-10-28 21:42
tags:
  - AI/머신러닝
aliases:
  - 다중회귀분석
  - 다중선형회귀
---

# 개요
[[지도학습]]의 회귀 분석 방법 중 하나로 [[단순 선형 회귀분석]]이 독립변수를 하나 가지고 있는 선형 회귀분석이라면, 다중 선형 회귀분석은 독립변수가 두 개 이상이고 종속변수가 y 하나인 선형 회귀분석이다.

# 내용
### 알고리즘
- 하나의 독립변수가 아닌 여러 개의 독립변수를 사용하는 회귀분석 기법이다.
	- [[단순 선형 회귀분석]]이 독립변수를 하나 가지고 있는 선형 회귀분석이라면,
	- 다중 선형 회귀분석은 독립변수가 두 개 이상이고 종속변수가 y 하나인 선형 회귀분석이다.
	  (a, b, ... 는 회귀계수, c는 y절편)
$$y=ax_1 + bx_2 + ... + c$$
### 분석 수행
- 분석 목표
	- 1999년 미국 캘리포니아 인구가구 통계 데이터셋에서 주택중위가치(median_house_value)에 영향을 주는 변수들을 찾아보고, 이 변수들을 포함하는 다중선형회귀모델을 생성하여 성능을 평가해본다.
- 접근 방법
	- 종속변수는 median_house_value
	- 상관성이 있다고 판단되는 변수를 선택한 후 각가에 대해 다중선형회귀 알고리즘을 적용하여 모델을 생성
	- 결정계수 값을 구해서 모델 성능을 평가
###### 필요 패키지 임포트
~~~python
## 다중 선형 회귀분석을 이용한 예측 문제 해결

## 1. 필요 패키지 임포트
import numpy as np
import pandas as pd
import sklearn
import matplotlib.pyplot as plt           # 맷플롯립 패키지 임포트

# 선형 회귀 모델을 위한 패키지 임포트
from sklearn.linear_model import LinearRegression
# 학습 및 테스트 데이터셋 분리를 위한 패키지 임포트
from sklearn.model_selection import train_test_split
~~~
###### 데이터 불러오기
~~~python
## 2. 데이터 불러오기
df = pd.read_csv("https://raw.githubusercontent.com/ageron/handson-ml/master/datasets/housing/housing.csv")
~~~
###### 데이터 탐색하기 
~~~python
## 3. 데이터 살펴보기
df
~~~
###### 데이터 전처리
- 변수들의 상관관계 분석시에 median_income을 제외하면 median_house_value 와의 상관성이 낮은 것을 알 수 있다.
- 전체  컬럼을 독립변수로 사용해 분석을 수행해 본다.
~~~python
## 4. 데이터 전처리
# 결측값이 있는 행 전체 제거 (axis가 1이면 열을 제거)
df = df.dropna(axis=0)

# ocean_proximity는 범주형 값으로 분석에서 제외
df = df.drop("ocean_proximity", axis=1)

# 변수들 간의 상관관계 분석
corr = df.corr(method="pearson")
print(corr)
~~~

~~~
                    median_house_value  
longitude                    -0.045398  
latitude                     -0.144638  
housing_median_age            0.106432  
total_rooms                   0.133294  
total_bedrooms                0.049686  
population                   -0.025300  
households                    0.064894  
median_income                 0.688355  
median_house_value            1.000000  
~~~
###### 분석 데이터셋 준비
~~~python
## 5. 분석 데이터셋 준비
# median_house_value를 제외한 나머지를 독립변수로 함
X = df.drop("median_house_value", axis=1)
y = df["median_house_value"]                  # 종속변수(목표변수)

# 분석 데이터셋 분할(7:3)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

print(X_train.shape)
print(X_test.shape)
print(y_train.shape)
print(y_test.shape)
~~~

~~~
(14303, 8)
(6130, 8)
(14303,)
(6130,)
~~~

###### 데이터 분석 수행
- 사이킷런의 선형 회귀분석 모듈인 LinearRegression을 사용
	- LinearRegression 객체를 생성하고 fit() 함수에 학습용 데이터(X_train)와 결정값 데이터(y_train) 를 입력해 호출하면 학습이 수행된다.
- 완성된 다중선형 회귀계수를 출력
	- 총 8개의 기울기와 1개의 y절편이 있다.
~~~python
## 6. 데이터 분석 수행
# LinearRegression 객체 생성
lr = LinearRegression()
lr.fit(X_train, y_train)          # 학습 수행

# 회귀식의 기울기와 y절편 출력
print("기울기 : ", lr.coef_)              # 다중회귀이기 때문에 다수의 기울기가 출력됨
print("y절편 : ", lr.intercept_)

# 학습이 완료된 lr객체에서 테스트 데이터셋으로 예측 수행
pred = lr.predict(X_test)
~~~

~~~
기울기 :  [-4.21262308e+04 -4.20623763e+04  1.18784999e+03 -8.57874086e+00
		  1.18123421e+02 -3.55751755e+01  3.73676747e+01  4.03297253e+04]
y절편 :  -3530241.307796566
~~~
###### 성능평가 및 시각화
- 다중 선형회귀분석 평가도 결정계수인 $R^2$ 점수로 예측 정확도를 판단할 수 있다. 결정계수 값이 클수록 모형의 예측능력이 좋다고 판단한다.
	- 사이킷런의 r2_score() 함수를 사용한다.
	- 첫번째 파라미터로 목표변수에 대한 테스트 데이터셋(y_test), 두번째 파라미터로 분석 결과로 예측된 데이터셋(pred)을 입력한다.
	- 실행결과 $R^2$ 값이 0.6445...로 정확도는 64% 이상임을 알 수 있다.
~~~python
## 7. 성능평가 및 시각화
from sklearn.metrics import r2_score
score = r2_score(y_test, pred)
print(score)

# 학습이 완료된 lr객체에서 학습 데이터셋으로 예측 수행
pred = lr.predict(X_train)

# 모델 성능 평가 - 학습 데이터셋
from sklearn.metrics import r2_score
score = r2_score(y_train, pred)
print(score)
~~~

~~~
0.6445130291082337
0.6334125389213838
~~~


# 출처


# 관련 노트
[[지도학습]]
[[단순 선형 회귀분석]]

# 외부 링크

