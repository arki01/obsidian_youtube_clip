---
Created: 2023-10-22 22:12
tags:
  - AI/머신러닝
aliases:
  - 로지스틱 회귀
---

# 개요

독립변수의 선형결합을 활용하여 사건의 발생 가능성을 예측(확률)하여 이항 분류를 진행하는 분석 방법
# 내용
### 개념
- 독립변수의 선형결합을 이용해 사건의 발생 가능성을 예측한다.
- '어떤 사건이 발생할 확률 or 발생하지 않을 확률'을 예측하여 분류를 진행한다. 
- 질병 유무와 같이 종속변수가 이항형 문제일 경우 사용할 수 있다. 보통 질병이 있는 경우를 '1', 없는 경우를 '0'으로 분석한다
### 용어
- 로짓변환
	- 오즈의 범위를 무한대로 변환함으로써 회귀분석을 적용할 수 있다.
	- 선형 회귀 모델은 특성의 값이 증가할수록 레이블의 값도 증가/감소 하는 형태를 가짐 
	- 범주형 레이블을 가지는 경우 특성의 값에 상관없이 0또는 1의 값을 가지는 것을 알 수 있음 
	- 분류 모델에서는 선형 모델과 달리 회귀 계수를 통한 직관적 해석이 어려움
	- 로짓 변환을 통해 비선형 형태를 선형 형태로 만들어 회귀 계수의 의미를 해석하기 쉽게 할 수 있음
	- 로짓 : 오즈에 로그를 씌운 값
	- 로짓 변환 : 오즈에 로그를 씌어 변환하는 과정
		![[로지스틱 회귀 - 로짓 변환.png]]

- [[오즈 (Odds)]]
	- 실패확률에 대한 성공확률의 비율
		- 오즈(Odds)가 3이라면 성공 확률이 실패 확률의 3배라는 의미 
	- 사건이 발생활 확률이 사건이 발생하지 않을 확률 의 몇배인지에 대한 개념이다.
	- 오즈비는 오즈의 비율로 오즈를 오즈로 나눔으로써 비교할 수 있다. 
		- 비흡연자에 대한 흡연자의 폐암 발병 오즈비를 구하면 4/0.25로 오즈비는 16이 되고, 
		- 이는 흡연자가 비흡연자 보다 폐암 발병 확률이 16배 높다고 해석할 수 있다.
- 로지스틱 함수
	- 함수의 결과 값이 0에서 1사이의 값을 반환하는 함수
- 시그모이드(Sigmoid) 함수
	- 로짓함수와 역함수 관계이다.

### 알고리즘
- 개요
	- 로지스틱 회귀 알고리즘은 회귀라는 명칭을 갖고 있지만, 회귀가 주로 예측을 하는 것과 달리 정답이 있는 데이터를 사용하여 분류 작업을 한다.
	- 시그모이드(sigmoid) 함수의 출력값을 각 분류 항목에 속하게 확률값으로 사용하며, 이 값은 0~1사이의 실수이다.
- 특징
	- 시그모이드 함수는 입력 값이 클수록 1에 수렴하고, 입력 값이 작으면 0으로 수렴한다.
	- 현재 갖고 있는 데이터를 통해 에러를 줄이는 방향으로 weight와 bias의 최적값을 찾아간다.
### 분석 수행
- 분석 목표
	- iris 데이터셋을 사용하여 붓꽃의 품종을 분류하는 문제를 로지스틱 회귀 알고리즘을 사용하여 해결
- 접근 방법
	- 로지스틱 회귀는 규제의 유형과 강도에 따라 분류(예측)의 정확도가 달라지므로, 적당한 값을 찾는 것이 중요
	- 규제가 필요한 이유는 학습용 데이터만 과도하게 학습하는 경우 다른 데이터에 대해서 예측력이 낮아지는 과대적합(overfitting) 문제가 발생하는 것을 예방하기 위함
	- 규제의 유형은 LogisticRegression 클래스 내 penalty 매개변수에서 설정할 수 있으며, 기본 값은 L2 규제(릿지 방식)이고, L1 규제(라쏘 방식)을 선택할 수 있다.
	- predict_proba() 메소드를 이용하여 분류 항목에 속할 확률을 확인할 수 있다.
	- decision_fuction() 메소드를 이용하여 모델이 선형 방정식을 확인할 수 있다.

###### 필요 패키지 임포트
~~~python
## 로지스틱 회귀(Logistic Regression)

## 1. 필요 패키지 임포트
import numpy as np
import pandas as pd
import sklearn

# 로지스틱 회귀 분류모델을 위한 패키지 임포트
from sklearn.linear_model import LogisticRegression
# 학습 및 테스트 데이터셋 분리를 위한 패키지 임포트
from sklearn.model_selection import train_test_split
~~~

###### 데이터 불러오기
~~~python
## 2. 데이터 불러오기
df = pd.read_csv("http://raw.githubusercontent.com/mwaskom/seaborn-data/master/iris.csv")
~~~
###### 데이터 탐색하기
~~~python
## 3. 데이터 살펴보기
df.info()
df.describe()
~~~
###### 데이터 전처리
~~~python
## 4. 데이터 전처리
# 각 독립변수별 Min-Max 정규화
from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler()
df[["sepal_length"]] = scaler.fit_transform(df[["sepal_length"]])
df[["sepal_width"]] = scaler.fit_transform(df[["sepal_width"]])
df[["petal_length"]] = scaler.fit_transform(df[["petal_length"]])
df[["petal_width"]] = scaler.fit_transform(df[["petal_width"]])
~~~
###### 분석 데이터셋 준비
~~~python
## 5. 분석 데이터셋 준비
# X는 독립변수(설명변수), y는 종속변수(목표변수)
X = df[["sepal_length","sepal_width","petal_length","petal_width"]]
y = df["species"]

# 분석 데이터셋 분할(8:2)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=10)

print(X_train.shape)
print(X_test.shape)
print(y_train.shape)
print(y_test.shape)
~~~
###### 데이터분석 수행
- 주어진 데이터로 붓꽃 종류를 구분하는 분류 문제이다.
- 분류를 위한 알고리즘 중에서 로지스틱 회귀를 이용
	- 사이킷런의 LogisticRegression를 사용한다.
	- LogisticRegression 객체를 생성하고 fit() 함수에 학습용 데이터(X_train)와 결정값 데이터(y_train)를 입력해 호출하면 학습이 수행된다.
- 학습이 완료된 lr 객체에서 테스트 데이터셋으로 분류(예측) 수행
~~~python
## 6. 데이터분석 수행
# LogisticRegression 객체 생성
lr = LogisticRegression()
lr.fit(X_train, y_train)        # 학습 수행

# 학습이 완료된 dt객체에서 테스트 데이터셋으로 예측 수행
pred = lr.predict(X_test)
~~~
###### 성능평가 및 시각화
- 분류(예측) 결과(pred)와 실제 분류 결과(y_test)를 비교하여 정확도를 평가
	- 모델의 분류 정확도는 83%임을 알 수 있다.
~~~python
## 7. 성능평가 및 시각화
from sklearn.metrics import accuracy_score
acc = accuracy_score(y_test, pred)
print(acc)
~~~

~~~
0.83333333333
~~~

# 출처


# 관련 노트


# 외부 링크

